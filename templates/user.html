<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>Add User</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <style>
    body{font-family:Inter, sans-serif;background:#f4f6f9;margin:0}
    .topbar{width:100%;background:#0d6efd;padding:12px 16px;color:#fff;display:flex;justify-content:space-between;align-items:center;position:sticky;top:0;z-index:99}
    .container{max-width:640px;margin:18px auto;padding:0 12px}
    .card{background:#fff;padding:16px;border-radius:12px;box-shadow:0 8px 20px rgba(0,0,0,0.06)}
    .form-row{margin-top:10px}
    .form-row label{display:block;margin-bottom:6px;font-weight:600}
    input{width:100%;padding:10px;border-radius:8px;border:1px solid #ddd}
    button{width:100%;padding:12px;border-radius:8px;border:none;background:#0d6efd;color:#fff;font-weight:700;margin-top:14px}
    #toast{visibility:hidden;min-width:220px;background:#28a745;color:#fff;text-align:center;border-radius:8px;padding:12px;position:fixed;z-index:99999;left:50%;bottom:30px;transform:translateX(-50%);box-shadow:0 3px 10px rgba(0,0,0,0.2);font-size:15px}
  </style>
</head>
<body>
  <div class="topbar">
    <div onclick="location.href='/'">üè† <span style="margin-left:8px">Home</span></div>
    <div onclick="location.href='/user'">‚ûï <span style="margin-left:8px">Add User</span></div>
  </div>

  <div class="container">
    <div class="card">
      <h3 style="margin:0 0 8px;text-align:center">Add New User</h3>

      <div class="form-row">
        <label for="name">Name</label>
        <input id="name" type="text" placeholder="Full name">
      </div>

      <div class="form-row">
        <label for="email">Email ID</label>
        <input id="email" type="email" placeholder="email@example.com">
      </div>

      <div class="form-row">
        <label for="salary">Salary</label>
        <input id="salary" type="number" placeholder="Monthly salary">
      </div>

      <div class="form-row">
        <label for="company">Company Name</label>
        <input id="company" type="text" placeholder="Company">
      </div>

      <button onclick="saveUser()">Save User</button>
    </div>
  </div>

  <div id="toast"></div>

<script>
function showToast(msg, timeout=1700){
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.style.visibility = 'visible';
  // green for success, red for errors
  t.style.background = msg.toLowerCase().includes('error') ? '#dc3545' : '#28a745';
  setTimeout(()=> t.style.visibility = 'hidden', timeout);
  // also send to App Inventor if present
  if(window.AppInventor && typeof window.AppInventor.setWebViewString === 'function'){
    try{ window.AppInventor.setWebViewString(msg); }catch(e){/*ignore*/ }
  }
}

async function saveUser(){
  const data = {
    name: document.getElementById('name').value.trim(),
    email: document.getElementById('email').value.trim(),
    salary: document.getElementById('salary').value.trim(),
    company: document.getElementById('company').value.trim()
  };
  if(!data.name){ showToast('Please enter name'); return; }
  try{
    const res = await fetch('/save-user', {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify(data)
    });
    const json = await res.json();
    showToast(json.message || 'User saved');
    // clear form
    document.getElementById('name').value=''; document.getElementById('email').value=''; document.getElementById('salary').value=''; document.getElementById('company').value='';
  }catch(e){
    console.error(e);
    showToast('Error saving user');
  }
}
</script>
</body>
</html>
