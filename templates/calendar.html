<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Attendance Calendar</title>

  <!-- FullCalendar -->
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

<!-- TOP NAVBAR -->
<div style="
  width: 100%;
  background: #0d6efd;
  padding: 12px 16px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  color: white;
  font-size: 18px;
  font-weight: 600;
  position: sticky;
  top: 0;
  z-index: 9999;">
  
  <!-- Home Icon -->
  <div onclick="window.location.href='/'" style="cursor:pointer; display:flex; align-items:center;">
    ğŸ  <span style="margin-left:6px;">Home</span>
  </div>

  <!-- Add User Icon -->
  <div onclick="window.location.href='/user'" style="cursor:pointer; display:flex; align-items:center;">
    â• <span style="margin-left:6px;">Add User</span>
  </div>

</div>

<h2 class="title">ğŸ“… Attendance Calendar</h2>
<div id="calendar"></div>

<!-- Attendance Form Popup -->
<div id="form-popup" class="popup">
    <h3>Mark Attendance</h3>

    <label>Name:</label>
    <select id="userName" class="form-control">
      <option value="">Select User</option>
    </select>

    <label>Status:</label>
    <select id="status" class="form-control">
      <option value="Present">Present</option>
      <option value="Absent">Absent</option>
      <option value="Half Day">Half Day</option>
      <option value="PL">PL</option>
      <option value="SL">SL</option>
      <option value="Comp-Off">Comp-Off</option>
    </select>

    <label>Note:</label>
    <textarea id="note" class="form-control"></textarea>

    <label>Comp-Off Comment:</label>
    <input type="text" id="comp_off" class="form-control">

    <button onclick="submitAttendance()">Submit</button>
    <button class="cancel" onclick="closeForm()">Cancel</button>
</div>

<!-- Calendar JS -->
<script src="{{ url_for('static', filename='calendar.js') }}"></script>

<script>
// ğŸ”¹ LOAD USERS INTO DROPDOWN
function loadUsers() {
    fetch("/users-list")
        .then(res => res.json())
        .then(users => {
            let dropdown = document.getElementById("userName");
            dropdown.innerHTML = `<option value="">Select User</option>`; 

            users.forEach(u => {
                dropdown.innerHTML += `<option value="${u.name}">${u.name}</option>`;
            });
        });
}

// Load users at page load
document.addEventListener("DOMContentLoaded", loadUsers);
</script>

</body>
</html>
