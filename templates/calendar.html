<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Attendance Calendar</title>
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <nav class="navbar bg-primary text-white d-flex justify-content-between">
    <button class="btn btn-light" onclick="window.location.href='/'">ğŸ  Home</button>
    <span class="fw-bold">ğŸ“… Calendar</span>
    <button class="btn btn-light" onclick="window.location.href='/user'">â• Add User</button>
  </nav>

  <div class="container mt-3">
    <div id="calendar"></div>
  </div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const calendarEl = document.getElementById('calendar');
  const calendar = new FullCalendar.Calendar(calendarEl, {
    initialView: 'dayGridMonth',
    height: 'auto',
    events: '/events',
    dateClick: function(info) {
      let userName = prompt("Enter Name for " + info.dateStr);
      if(userName){
        let status = prompt("Enter Status (Present/Absent/PL/SL/Comp-Off):");
        fetch("/mark", {
          method:"POST",
          headers:{"Content-Type":"application/json"},
          body: JSON.stringify({date: info.dateStr, name:userName, status:status, note:"", comp_off:""})
        }).then(res=>res.json()).then(d=>alert(d.message))
      }
    }
  });
  calendar.render();
});
</script>
</body>
</html>
