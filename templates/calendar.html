{% extends "base.html" %}
{% block content %}
<h2>ðŸ“… Attendance Calendar</h2>
<div id="calendar"></div>

<!-- Attendance Popup -->
<div id="form-popup" class="popup">
  <h3>Mark Attendance</h3>
  <select id="userName" class="form-control">
    <option value="">Select User</option>
  </select>

  <label>Status:</label>
  <select id="status">
    <option value="Present">Present</option>
    <option value="Absent">Absent</option>
    <option value="Half Day">Half Day</option>
    <option value="PL">PL</option>
    <option value="SL">SL</option>
    <option value="Comp-Off">Comp-Off</option>
  </select>

  <label>Note:</label>
  <textarea id="note"></textarea>

  <label>Comp-Off Comment:</label>
  <input type="text" id="comp_off">

  <button onclick="submitAttendance()">Submit</button>
  <button class="cancel" onclick="closeForm()">Cancel</button>
</div>

<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>
<script src="{{ url_for('static', filename='calendar.js') }}"></script>

<script>
function loadUsers() {
    fetch("/users-list")
        .then(res => res.json())
        .then(users => {
            let dropdown = document.getElementById("userName");
            dropdown.innerHTML = `<option value="">Select User</option>`; 
            users.forEach(u => dropdown.innerHTML += `<option value="${u.name}">${u.name}</option>`);
        });
}
document.addEventListener("DOMContentLoaded", loadUsers);
</script>
{% endblock %}
